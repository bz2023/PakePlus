// by Zhou Bingzhen
var _0x431179=_0x1b92;(function(_0x349e14,_0x42424f){var _0x59db7c=_0x1b92,_0x1833f0=_0x349e14();while(!![]){try{var _0x3c0261=-parseInt(_0x59db7c(0x10e))/0x1*(parseInt(_0x59db7c(0x105))/0x2)+parseInt(_0x59db7c(0x113))/0x3+-parseInt(_0x59db7c(0xef))/0x4*(parseInt(_0x59db7c(0xe9))/0x5)+-parseInt(_0x59db7c(0xdf))/0x6*(parseInt(_0x59db7c(0xd4))/0x7)+-parseInt(_0x59db7c(0xdc))/0x8+-parseInt(_0x59db7c(0xed))/0x9+parseInt(_0x59db7c(0x10a))/0xa*(parseInt(_0x59db7c(0x100))/0xb);if(_0x3c0261===_0x42424f)break;else _0x1833f0['push'](_0x1833f0['shift']());}catch(_0x514a2c){_0x1833f0['push'](_0x1833f0['shift']());}}}(_0x6632,0x2a1c8));var langeisen=!![];lang=='zh'&&(langeisen=![]);function changeLang(){var _0x1c8fab=_0x1b92;langeisen?ggbApplet[_0x1c8fab(0xd5)]('zh'):ggbApplet[_0x1c8fab(0xd5)]('en'),langeisen=!langeisen;}document[_0x431179(0xde)]('keydown',function(_0x26c3fc){var _0x53faad=_0x431179,_0x56425c={'Orgeu':function(_0x5c9759,_0x4603d8){return _0x5c9759===_0x4603d8;},'PQQVb':'ArrowUp','QloIX':function(_0x379132){return _0x379132();},'ikWvY':'ArrowDown'};if(_0x56425c['Orgeu'](_0x26c3fc[_0x53faad(0x10c)],_0x56425c['PQQVb'])){_0x56425c[_0x53faad(0xeb)](Previous);return;}if(_0x56425c[_0x53faad(0xf9)](_0x26c3fc[_0x53faad(0x10c)],_0x56425c[_0x53faad(0xd7)])){_0x56425c['QloIX'](Next);return;}});function saveGgbBase(){var _0x55ecc4=_0x431179;ggbApplet[_0x55ecc4(0xd9)]();};document[_0x431179(0xe6)](_0x431179(0xe2))[_0x431179(0x101)]=n,document[_0x431179(0xe6)]('Cpages')[_0x431179(0x101)]=c+0x1;function SetPage(){var _0x2be0d8=_0x431179,_0x130524={'kJPKI':function(_0xeb5236){return _0xeb5236();},'VhRpU':_0x2be0d8(0x102)};_0x130524[_0x2be0d8(0x110)](saveGgbBase),strs[c]=ggbApplet['getBase64'](),c=document['getElementById'](_0x130524['VhRpU'])[_0x2be0d8(0x101)]-0x1,ggbApplet[_0x2be0d8(0xca)](strs[c]);};function Previous(){var _0xf364b3=_0x431179,_0x197925={'TSEhv':function(_0x3b8b61,_0xfc9096){return _0x3b8b61==_0xfc9096;},'IkXVl':function(_0x1684ad,_0x3066b6){return _0x1684ad-_0x3066b6;},'ITFdw':_0xf364b3(0x102)};saveGgbBase(),strs[c]=ggbApplet[_0xf364b3(0xd9)](),_0x197925[_0xf364b3(0xe7)](c,0x0)?c=_0x197925[_0xf364b3(0xea)](n,0x1):c=c-0x1,ggbApplet[_0xf364b3(0xca)](strs[c]),document[_0xf364b3(0xe6)](_0x197925[_0xf364b3(0xd8)])['value']=c+0x1;};function _0x6632(){var _0x153e35=['11IniACJ','value','Cpages','none','dJwes','219776aeXKIS','KUffs','RaSPK','Base64','MnVxk','8750730BADNWV','execCommand','key','CrmQl','2QfxYob','VURIb','kJPKI','TdqRG','yGFrL','515910qDYagq','uRjmP','Rjzbp','vBghP','MfgyO','4|3|1|0|2','text/html\x20;charset=utf-8','fTCxQ','RwYtP','exportSVG','JFAkI','select','fCtNq','setBase64','lFWVi','acIxz','4|1|0|3|2','dPttm','evalCommand','.html','blyVj','HWSXQ','.svg','333403kiAewE','setLanguage','MwIyc','ikWvY','ITFdw','getBase64','OPKeN','SetPerspective(\x22AGP\x22)','629056bFAOEq','1|4|2|3|0','addEventListener','24xyERwp','ITRUA','4|2|0|3|5|1','tolpages','mBcPW','splice','qEfnG','getElementById','TSEhv','display','20cpgbbL','IkXVl','QloIX','filename','1457235MYljVg','XvzJu','223716PHbufx','split','NWIPl','DHjGp','style','Xrfzs','NtzSM','XeNXL','SetPerspective(\x22(G/D)(A/P)\x22)','gEsKQ','Orgeu','PgRTa','rOKqx','2|5|4|6|1|7|3|0','nRhRM','FKfIY','xcgKJ'];_0x6632=function(){return _0x153e35;};return _0x6632();}function Next(){var _0x21f0c9=_0x431179,_0x5ba357={'Rjzbp':_0x21f0c9(0xdd),'blyVj':function(_0x5c2b48,_0x5b00a4){return _0x5c2b48+_0x5b00a4;},'vBghP':function(_0x371582){return _0x371582();},'HWSXQ':function(_0x4b3dc7,_0x309cc8){return _0x4b3dc7==_0x309cc8;},'dJwes':function(_0x5b7332,_0x570f5a){return _0x5b7332-_0x570f5a;}},_0xb291e=_0x5ba357[_0x21f0c9(0x115)]['split']('|'),_0x344f97=0x0;while(!![]){switch(_0xb291e[_0x344f97++]){case'0':document[_0x21f0c9(0xe6)]('Cpages')['value']=_0x5ba357[_0x21f0c9(0xd1)](c,0x1);continue;case'1':_0x5ba357[_0x21f0c9(0x116)](saveGgbBase);continue;case'2':_0x5ba357[_0x21f0c9(0xd2)](c,_0x5ba357[_0x21f0c9(0x104)](n,0x1))?c=0x0:c=_0x5ba357['blyVj'](c,0x1);continue;case'3':ggbApplet['setBase64'](strs[c]);continue;case'4':strs[c]=ggbApplet[_0x21f0c9(0xd9)]();continue;}break;}};function First(){var _0x37d872=_0x431179,_0xda3ff4={'FeGdT':_0x37d872(0xcd),'lsiGr':_0x37d872(0x102),'qEfnG':function(_0x297344,_0x362137){return _0x297344+_0x362137;},'Xrfzs':function(_0x4ad053){return _0x4ad053();}},_0x2b48cb=_0xda3ff4['FeGdT']['split']('|'),_0x1d18bb=0x0;while(!![]){switch(_0x2b48cb[_0x1d18bb++]){case'0':c=0x0;continue;case'1':strs[c]=ggbApplet[_0x37d872(0xd9)]();continue;case'2':document[_0x37d872(0xe6)](_0xda3ff4['lsiGr'])['value']=_0xda3ff4[_0x37d872(0xe5)](c,0x1);continue;case'3':ggbApplet[_0x37d872(0xca)](strs[c]);continue;case'4':_0xda3ff4[_0x37d872(0xf4)](saveGgbBase);continue;}break;}};function Last(){var _0x22ca66=_0x431179,_0x17b2d2={'MfgyO':function(_0x185cb1,_0x1cef95){return _0x185cb1-_0x1cef95;},'MwIyc':_0x22ca66(0x102)},_0x5eabbb=_0x22ca66(0xc2)[_0x22ca66(0xf0)]('|'),_0x583688=0x0;while(!![]){switch(_0x5eabbb[_0x583688++]){case'0':ggbApplet['setBase64'](strs[c]);continue;case'1':c=_0x17b2d2[_0x22ca66(0x117)](n,0x1);continue;case'2':document['getElementById'](_0x17b2d2[_0x22ca66(0xd6)])[_0x22ca66(0x101)]=c+0x1;continue;case'3':strs[c]=ggbApplet['getBase64']();continue;case'4':saveGgbBase();continue;}break;}};function AddPage(){var _0x5d3636=_0x431179,_0x17cc97={'usWfr':function(_0x23e057){return _0x23e057();},'fCtNq':function(_0x37b256,_0x50abc1){return _0x37b256+_0x50abc1;},'KUffs':function(_0x32f88e,_0x15bd52){return _0x32f88e+_0x15bd52;},'lFWVi':_0x5d3636(0x102),'knWEw':'tolpages'};_0x17cc97['usWfr'](saveGgbBase),strs[c]=ggbApplet[_0x5d3636(0xd9)](),strs[_0x5d3636(0xe4)](_0x17cc97[_0x5d3636(0xc9)](c,0x1),0x0,ggbpure),n=_0x17cc97[_0x5d3636(0x106)](n,0x1),c=_0x17cc97[_0x5d3636(0xc9)](c,0x1),ggbApplet[_0x5d3636(0xca)](ggbpure),document[_0x5d3636(0xe6)](_0x17cc97[_0x5d3636(0xcb)])[_0x5d3636(0x101)]=_0x17cc97['KUffs'](c,0x1),document['getElementById'](_0x17cc97['knWEw'])[_0x5d3636(0x101)]=n;};function ClonePage(){var _0x3fc202=_0x431179,_0x9c2921={'CrmQl':_0x3fc202(0xfc),'NtzSM':'tolpages','EJogl':function(_0x79421b,_0x3e26c2){return _0x79421b+_0x3e26c2;},'rOKqx':function(_0x41fc1){return _0x41fc1();},'ITRUA':'Cpages','VURIb':function(_0x2f8732,_0x5e7125){return _0x2f8732+_0x5e7125;}},_0x2a9fb2=_0x9c2921[_0x3fc202(0x10d)][_0x3fc202(0xf0)]('|'),_0x17bd3a=0x0;while(!![]){switch(_0x2a9fb2[_0x17bd3a++]){case'0':document[_0x3fc202(0xe6)](_0x9c2921[_0x3fc202(0xf5)])[_0x3fc202(0x101)]=n;continue;case'1':c=_0x9c2921['EJogl'](c,0x1);continue;case'2':_0x9c2921[_0x3fc202(0xfb)](saveGgbBase);continue;case'3':document[_0x3fc202(0xe6)](_0x9c2921[_0x3fc202(0xe0)])[_0x3fc202(0x101)]=_0x9c2921[_0x3fc202(0x10f)](c,0x1);continue;case'4':strs[_0x3fc202(0xe4)](c+0x1,0x0,ggbApplet['getBase64']());continue;case'5':strs[c]=ggbApplet['getBase64']();continue;case'6':n=_0x9c2921[_0x3fc202(0x10f)](n,0x1);continue;case'7':ggbApplet[_0x3fc202(0xca)](ggbApplet[_0x3fc202(0xd9)]());continue;}break;}};function _0x1b92(_0x450c93,_0x3a0235){var _0x66326f=_0x6632();return _0x1b92=function(_0x1b920c,_0x7b3d10){_0x1b920c=_0x1b920c-0xc2;var _0xd707a2=_0x66326f[_0x1b920c];return _0xd707a2;},_0x1b92(_0x450c93,_0x3a0235);}var dc=0x0,TMPpage=new Array();function DeletePage(){var _0x2258d8=_0x431179,_0x48a0eb={'nRhRM':function(_0x21a43f,_0x21f1e1){return _0x21a43f!=_0x21f1e1;},'TdqRG':function(_0x5354b4,_0x18c6ca){return _0x5354b4-_0x18c6ca;},'RwYtP':function(_0xdd64f7,_0x1a9ddc){return _0xdd64f7==_0x1a9ddc;},'yGFrL':function(_0x28c599,_0x4d21a6){return _0x28c599-_0x4d21a6;},'NWIPl':_0x2258d8(0x102),'gEsKQ':_0x2258d8(0xe2),'RaSPK':_0x2258d8(0xe1),'Nwhoq':function(_0x545f38,_0x496557){return _0x545f38+_0x496557;},'XeNXL':function(_0x4a43d8){return _0x4a43d8();}};if(_0x48a0eb[_0x2258d8(0xfd)](n,0x1))TMPpage[dc]=ggbApplet[_0x2258d8(0xd9)](),dc=dc+0x1,strs[_0x2258d8(0xe4)](c,0x1),n=_0x48a0eb[_0x2258d8(0x111)](n,0x1),_0x48a0eb[_0x2258d8(0xc5)](c,0x0)?c=0x0:c=_0x48a0eb[_0x2258d8(0x112)](c,0x1),ggbApplet['setBase64'](strs[c]),document[_0x2258d8(0xe6)](_0x48a0eb[_0x2258d8(0xf1)])[_0x2258d8(0x101)]=c+0x1,document[_0x2258d8(0xe6)](_0x48a0eb[_0x2258d8(0xf8)])[_0x2258d8(0x101)]=n;else{var _0x95e312=_0x48a0eb[_0x2258d8(0x107)][_0x2258d8(0xf0)]('|'),_0x4a3922=0x0;while(!![]){switch(_0x95e312[_0x4a3922++]){case'0':ggbApplet['setBase64'](ggbpure);continue;case'1':document[_0x2258d8(0xe6)](_0x48a0eb['gEsKQ'])[_0x2258d8(0x101)]=0x1;continue;case'2':dc=_0x48a0eb['Nwhoq'](dc,0x1);continue;case'3':_0x48a0eb[_0x2258d8(0xf6)](saveGgbBase);continue;case'4':TMPpage[dc]=ggbApplet[_0x2258d8(0xd9)]();continue;case'5':document[_0x2258d8(0xe6)](_0x48a0eb[_0x2258d8(0xf1)])[_0x2258d8(0x101)]=0x1;continue;}break;}}};function recoverDeletePage(){var _0x109239=_0x431179,_0x1d6bdd={'RiuJL':function(_0x378071,_0x398b1d){return _0x378071!=_0x398b1d;},'uRjmP':function(_0x22acbd){return _0x22acbd();}};_0x1d6bdd['RiuJL'](dc,0x0)&&(_0x1d6bdd[_0x109239(0x114)](AddPage),dc=dc-0x1,ggbApplet['setBase64'](TMPpage[dc]));;};var btct=0x0;function Hidebt(){var _0x49fc74=_0x431179,_0x5889f4={'xcgKJ':function(_0x20bf31,_0x263aad){return _0x20bf31==_0x263aad;},'Phrdv':_0x49fc74(0x103)};_0x5889f4[_0x49fc74(0xff)](btct,0x0)?(document[_0x49fc74(0xe6)]('bt')['style'][_0x49fc74(0xe8)]=_0x5889f4['Phrdv'],btct=0x1):(document[_0x49fc74(0xe6)]('bt')[_0x49fc74(0xf3)][_0x49fc74(0xe8)]='',btct=0x0);};function saveGgbFile(){var _0x21300c=_0x431179,_0x536952={'dPttm':_0x21300c(0x108),'fTCxQ':'copy'};ggbApplet['getBase64'](function(_0x29bb6d){var _0x4451c7=_0x21300c;document[_0x4451c7(0xe6)](_0x536952[_0x4451c7(0xce)])[_0x4451c7(0x101)]=_0x29bb6d,document['getElementById'](_0x536952[_0x4451c7(0xce)])[_0x4451c7(0xc8)](),document[_0x4451c7(0x10b)](_0x536952[_0x4451c7(0xc4)]);});};function loadGgbFile(){var _0x5d4e51=_0x431179,_0x18ace2={'acIxz':_0x5d4e51(0x108),'OPKeN':function(_0x3107f9,_0x28732d){return _0x3107f9>_0x28732d;}},_0x5044a0=document['getElementById'](_0x18ace2[_0x5d4e51(0xcc)])[_0x5d4e51(0x101)];_0x18ace2[_0x5d4e51(0xda)](_0x5044a0['length'],0x14)?ggbApplet[_0x5d4e51(0xca)](_0x5044a0):(saveGgbBase(),ggbApplet[_0x5d4e51(0xca)](ggbApplet[_0x5d4e51(0xd9)]()));};function fresh(){var _0x24d32d=_0x431179,_0x78ef13={'mBcPW':function(_0x3d6473){return _0x3d6473();}};_0x78ef13[_0x24d32d(0xe3)](saveGgbBase),ggbApplet['setBase64'](ggbApplet['getBase64']());};function SetPerspective(){var _0x476a75=_0x431179,_0x1dad67={'VujFr':_0x476a75(0xf7)};saveGgbBase(),strs[c]=ggbApplet[_0x476a75(0xd9)](),ggbApplet[_0x476a75(0xcf)](_0x1dad67['VujFr']);};function recoverSetPerspective(){var _0xded1e0=_0x431179,_0x13ab1d={'DHjGp':_0xded1e0(0xdb)};ggbApplet['evalCommand'](_0x13ab1d[_0xded1e0(0xf2)]);};function ExportImage(){var _0xb7c307=_0x431179,_0x6aa469={'XPySj':_0xb7c307(0x102),'MnVxk':_0xb7c307(0xec),'PgRTa':_0xb7c307(0xd3)},_0x1e8b35=document[_0xb7c307(0xe6)](_0x6aa469['XPySj'])['value'],_0x21d87c=document['getElementById'](_0x6aa469[_0xb7c307(0x109)])['value']+String(_0x1e8b35)+_0x6aa469[_0xb7c307(0xfa)];ggbApplet[_0xb7c307(0xc6)](_0x21d87c);};function savehttp(_0x25e4d2){var _0x32ebfc=_0x431179,_0x567389={'cKgMJ':_0x32ebfc(0xc3),'JFAkI':function(_0x3b6593,_0x388343){return _0x3b6593+_0x388343;},'XvzJu':_0x32ebfc(0xec),'FKfIY':function(_0x1ffc05,_0x58b144,_0x3a51f5){return _0x1ffc05(_0x58b144,_0x3a51f5);}},_0x41e1cc=new Blob(_0x25e4d2,{'type':_0x567389['cKgMJ']}),_0x5e813f=_0x567389[_0x32ebfc(0xc7)](document[_0x32ebfc(0xe6)](_0x567389[_0x32ebfc(0xee)])[_0x32ebfc(0x101)],_0x32ebfc(0xd0));_0x567389[_0x32ebfc(0xfe)](saveAs,_0x41e1cc,_0x5e813f);}



function AddPage2(){
    saveGgbBase();
    strs[c] = ggbApplet.getBase64();
    strs.splice(c+1, 0, ggbpure2);
    n = n + 1;
    c = c + 1;
    ggbApplet.setBase64(ggbpure2);
    document.getElementById("Cpages").value = c+1;
    document.getElementById("tolpages").value = n;
};



function saveOnePage(){ 
saveGgbBase();
let strxx =new Array();

let tmp1 = ggbApplet.getBase64();
let tmp2 = `
<!-- by zbzhen, https://kz16.top -->
<!DOCTYPE html><html><head><meta charset="utf-8"/><link rel="icon" href="https://kz16.top/kz16logo.svg" type="image/x-icon"/><meta name=viewport content="width=device-width,initial-scale=1"><style type="text/css">body,html{margin: 0;padding: 0;height: 100%;overflow: hidden;}</style>
<script>
    let online_libpath = '${onlinepath}';
    let offline_libpath = '${offlinepath}';
    let vvvvv = './js/v${myvv}.js';
    let deployggb_path = "geogebra/deployggb.js";
    let web3d_path = "geogebra/5.0/web3d/";
    let ttttk = false;
    function loadLocalScript(url) {
        var localScript = document.createElement('script');
        localScript.src = url;
        document.head.appendChild(localScript);
    }
    function checkJSFile(url, callback) {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;
        script.onload = function() {
            loadLocalScript(offline_libpath+deployggb_path);
            callback(true);
        };
        script.onerror = function() {
            loadLocalScript(online_libpath+deployggb_path);
            callback(false);
        };
        document.head.appendChild(script);
    }
    checkJSFile(vvvvv, function(isAccessible) {
        ttttk = isAccessible;
        console.log(isAccessible);
    });
</script>

</head><body><div id="ggbApplet"></div>

<script>var mywidth = window.innerWidth;var myheight = window.innerHeight;
var parameters = {"id": "ggbApplet","width":mywidth,"height":myheight,"showAlgebraInput":false,"showToolBar":false,"borderColor":"white","language":"en","enableRightClick":true,"enableShiftDragZoom":true, "enableLabelDrags":true,
"ggbBase64":"${tmp1}"
};
window.addEventListener("resize", function(){ggbApplet.setSize( window.innerWidth, window.innerHeight);});
window.onload = function () { 
    let applet2 = new GGBApplet(parameters,  '5.0');  
    if (ttttk){
        applet2.setHTML5Codebase(offline_libpath+web3d_path); 
    }else{
        applet2.setHTML5Codebase(online_libpath+web3d_path); 
    }
    applet2.inject("ggbApplet"); 
};
</script>
</body></html>
`;

strxx[0] =  tmp2;
savehttp(strxx);
}



function getOfflineHtmlStrx(){ 
saveGgbBase();
strs[c] = ggbApplet.getBase64();
let stryyy =new Array();

let tmp0 = `
<!-- by zbzhen, https://kz16.top -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="https://kz16.top/kz16logo.svg" type="image/x-icon" />
    <meta name=viewport content="width=device-width,initial-scale=1">
    <style type="text/css">
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        a {
            text-decoration: none;
        }
        #bt {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 30px;
            background-color: rgb(247, 247, 247);
        }
        main {
            position: absolute;
            top: 30px;
            bottom: 0;
            left: 0;
            right: 0;
            overflow: hidden;
        }
        .mya {
            opacity: 0.05;
        }
        .mya:hover {
            opacity: 1;
        }
    </style>
<script>
    var ggbs = new Array();
    var mywidth = window.innerWidth; var myheight = window.innerHeight - 30;
`;

stryyy[0] = tmp0;

for(var i=0; i<n; i++){
    var tmpxxx = strs[i];
    stryyy[i+1] = 'ggbs['+i+'] = "' + tmpxxx + '";';
};

let  tmp2 = `
</script>
    
<script>
    let online_libpath = '${onlinepath}';
    let offline_libpath = '${offlinepath}';
    let deployggb_path = "geogebra/deployggb.js";
    let FileSaver_path = "js/FileSaver.js/FileSaver.js";
    let lang_path = "js/lang${myvv}.js";
    let ggbppt_path = "js/ggbppt${myvv}.js";
    let save_path = "js/save.js";
    let web3d_path = "geogebra/5.0/web3d/";
    let vvvvv = './js/v${myvv}.js';
    let ttttk = false;
    function loadLocalScript(url) {
        var localScript = document.createElement('script');
        localScript.src = url;
        document.head.appendChild(localScript);
    }
    function checkJSFile(url, callback) {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;
        script.onload = function() {
            loadLocalScript(offline_libpath+deployggb_path);
            loadLocalScript(offline_libpath+FileSaver_path);
            loadLocalScript(offline_libpath+lang_path);
            loadLocalScript(offline_libpath+ggbppt_path);
            loadLocalScript(offline_libpath+save_path);
            callback(true);
        };
        script.onerror = function() {
            loadLocalScript(online_libpath+deployggb_path);
            loadLocalScript(online_libpath+FileSaver_path);
            loadLocalScript(online_libpath+lang_path);
            loadLocalScript(online_libpath+ggbppt_path);
            loadLocalScript(online_libpath+save_path);
            callback(false);
        };
        document.head.appendChild(script);
    }
    checkJSFile(vvvvv, function(isAccessible) {
        ttttk = isAccessible;
        console.log(isAccessible);
    });
</script>

</head>
<body>
<div id="bt">&nbsp;&nbsp;<a href="javascript:ClonePage()" title="克隆页面">⚣&nbsp;</a> 
        <a href="javascript:AddPage()" title="新加页面, 速度快, 剪头不美观, 适合绘制几何图">&nbsp;✚&nbsp;</a> 
        <a href="javascript:AddPage2()" title="新加页面, 速度慢, 剪头美观, 适合绘制函数图. 点函数图会自动裁剪">&nbsp;<span style="color:#ffffff"><strong><span style="background-color:#0000fd">&nbsp;✚&nbsp;</span></strong></span> &nbsp;</a> 
        <a href="javascript:First()">&nbsp;|&lt;&lt;</a> <a
        href="javascript:Previous()">⇦</a> &nbsp;<a href="javascript:SetPage()"><span
            style="font-size:22px">⟳</span></a><textarea  name="Cpages" id="Cpages" cols=3 rows=1
        style="resize:none; border-style:none;overflow:hidden;height:16px; text-align:right" onkeydown="disableEnterKey(event)">1</textarea>/
        <textarea disabled
        name="tolpages" id="tolpages" cols=3 rows=1
        style="resize:none; border-style:none;overflow:hidden;height:16px;background-color: rgb(247, 247, 247)" >1</textarea>
        <a
        href="javascript:Next()">⇨</a> &nbsp;&nbsp;<a href="javascript:Last()">&gt;&gt;|</a>&nbsp;&nbsp;<a
        href="javascript:ExportImage()" title="导出svg图片">⇩svg</a>
        <a href="javascript:saveAllPPT()" title="下载所有页面, 在线与离线共存, 放到离线包里可离线显示, 离线包在Help里">&nbsp;&nbsp;⇩All &nbsp;</a> <textarea name="filename"
        id="filename" cols=8 rows=1 style="resize:none;height:19px">ggbppt</textarea><a
        href="javascript:saveOnePage()" title="下载无边框单页用于插入ppt中的html文件, 放到离线包里可离线显示, 离线包在Help里">&nbsp;⇩One &nbsp;</a><a
        href="javascript:recoverSetPerspective()" title="恢复原来视图">四</a>&nbsp;&nbsp;&nbsp;<a
        href="javascript:SetPerspective()" title="设置视图, 方便导出固定尺寸的图片">田</a>&nbsp;&nbsp;<a
        href="javascript:saveGgbFile()" title="保存base64代码">⇈</a> &nbsp;&nbsp;<a href="javascript:loadGgbFile()"
        title="导入base64代码">⇊</a>&nbsp;<textarea name="Base64" id="Base64" cols=20 rows=1
        style="resize:none;height:19px"></textarea>&nbsp;<a href="javascript:recoverDeletePage()"
        title="恢复删除的页面">↶</a> &nbsp;<a href="javascript:DeletePage()" title="删除页面,按左侧按钮可以恢复">&#10005; </a>
    &nbsp;&nbsp;<a href="https://kz16.top/ggb/ggbpptReadMe.html" title="详细教程" target="_blank">Help</a>
    &nbsp;&nbsp;<a href="./geogebra/5.0/notes.html" title="打开notes" target="_blank">notes</a> &nbsp;&nbsp;<a
        href="javascript:changeLang()" title="切换语言">中</a>&nbsp;&nbsp;<a href="javascript:openfile()"
        title="定位文件(必须与当前文件同路径同名)">✉</a>&nbsp;&nbsp;<a href="javascript:savefile()"
        title="保存文件(需要提前定位文件)">✔</a>&nbsp;&nbsp;<a href="javascript:window.open(window.location.href,'_blank')"
        title="多开">❆</a></div>
<main>
    <div id="ggbApplet"></div>
</main>
<div style="position:absolute; bottom:0; right:0; cursor: pointer;z-index: 1000;"><a onclick="javascript:Previous()"
        class="mya" style=" font-size: 30px;" onmouseover="event.preventDefault();">&nbsp; ⇦ &nbsp;</a><a
        onclick="javascript:Next()" class="mya" style=" font-size: 30px;" onmouseover="event.preventDefault();">
        &nbsp;⇨&nbsp;</a><a onclick="javascript:toggleFullscreen();" class="mya" style=" font-size: 30px;"
        title="全屏播放,再按可隐藏画图按钮,第三次点击退出全屏" onmouseover="event.preventDefault();"> &nbsp;▶️&nbsp; </a></div>
<script>
    window.addEventListener("resize", function () { ggbApplet.setSize(window.innerWidth, window.innerHeight - 30); });
    window.onload = function () { 
    let applet2 = new GGBApplet(parameters,  '5.0');  
    if (ttttk){
        applet2.setHTML5Codebase(offline_libpath+web3d_path); 
    }else{
        applet2.setHTML5Codebase(online_libpath+web3d_path); 
    }
    applet2.inject("ggbApplet"); };
</script>
<script>window.addEventListener("beforeunload", function (e) { var confirmationMessage = "Not save"; e.returnValue = confirmationMessage; return confirmationMessage; });</script>
</body>
</html>
`;

stryyy[n+1] = tmp2;
return stryyy

};


function getOfflineHtmlStr(){ 
    let stryyy = new Array();
    stryyy = getOfflineHtmlStrx();
    return stryyy.join('');
}

function saveAllPPT(){ 
    let stryyy = new Array();
    stryyy = getOfflineHtmlStrx();
    savehttp(stryyy);
}



